\hypertarget{error_state_kalman_8m}{\section{C\-:/arbitros/trunk/drivers/matlab/ins/error\-State\-Kalman.m File Reference}
\label{error_state_kalman_8m}\index{C\-:/arbitros/trunk/drivers/matlab/ins/error\-State\-Kalman.\-m@{C\-:/arbitros/trunk/drivers/matlab/ins/error\-State\-Kalman.\-m}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
attitude system noise is \hyperlink{ellipsoid__fit_8m_a44f09445f90540f74824a1839982d0de}{a} matrix \hyperlink{error_state_kalman_8m_a69139acee4d44a784a98346d44cb78c6}{Qatt} (1, 1) = (.\-38$\ast$\hyperlink{mag_plot_8m_aee307926074ece43f45be386744f9397}{pi}/180)$\ast$\hyperlink{ahrs_8m_a4ff248a90c101bf3e3713c17cd3ffab0}{dt}
\item 
gyro random noise \hyperlink{mag_plot_8m_a9336ebf25087d91c818ee6e9ec29f8c1}{x} axis in rad \hyperlink{error_state_kalman_8m_a3cbf8063018be67a2f9313a4b99270d8}{sec} \hyperlink{error_state_kalman_8m_a77865d2a79630f6bb4acfbe319d430f0}{Qatt} (2, 2) = (.\-38$\ast$\hyperlink{mag_plot_8m_aee307926074ece43f45be386744f9397}{pi}/180)$\ast$\hyperlink{ahrs_8m_a4ff248a90c101bf3e3713c17cd3ffab0}{dt}
\item 
gyro random noise \hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} axis in rad \hyperlink{error_state_kalman_8m_a3cbf8063018be67a2f9313a4b99270d8}{sec} \hyperlink{error_state_kalman_8m_a3e088d997e83bd453fb3f7c3baaba22e}{Qatt} (3, 3) = (.\-38$\ast$\hyperlink{mag_plot_8m_aee307926074ece43f45be386744f9397}{pi}/180)$\ast$\hyperlink{ahrs_8m_a4ff248a90c101bf3e3713c17cd3ffab0}{dt}
\item 
\hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros} (3)
\item 
\hyperlink{error_state_kalman_8m_a9e043f1de5477b7deb4976cd2bd554e2}{R} (1, 1)
\item 
Accelerometer \hyperlink{mag_plot_8m_a9336ebf25087d91c818ee6e9ec29f8c1}{x} \hyperlink{dcm_normalize_8m_a5ee817c076587e88884910406497df94}{error} \hyperlink{error_state_kalman_8m_aea61c32f128d177a875fe8d6cd1f99e4}{R} (2, 2)
\item 
Accelerometer \hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} \hyperlink{dcm_normalize_8m_a5ee817c076587e88884910406497df94}{error} \hyperlink{error_state_kalman_8m_a7972c14f231c13f8633c0a12e59e317c}{R} (3, 3)
\item 
\hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_abc48706ebe7c3762ebebc1b79cf569dc}{if} (\hyperlink{ahrs_8m_abd5a608aae9055fc55bf7bf0277abdf7}{res}(2) $>$ 5 $\ast$\hyperlink{ahrs_8m_a32aadae37f025a94364f993e73bb5a78}{r\-Var}(2)) \hyperlink{error_state_kalman_8m_a3e088d997e83bd453fb3f7c3baaba22e}{Qatt}(2
\item 
\hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_a01152faaa45b1077daa95054b190368a}{if} (\hyperlink{ahrs_8m_abd5a608aae9055fc55bf7bf0277abdf7}{res}(3) $>$ \hyperlink{ahrs_8m_a32aadae37f025a94364f993e73bb5a78}{r\-Var}(3)) \hyperlink{error_state_kalman_8m_a3e088d997e83bd453fb3f7c3baaba22e}{Qatt}(3
\item 
\hyperlink{error_state_kalman_8m_a1765b8411a385cb7cbfc189a91e6ec36}{Qg\-Bias} (1, 1)
\item 
\hyperlink{error_state_kalman_8m_a4e5570b54d956ce11e4df196479225c2}{Qg\-Bias} (2, 2)
\item 
\hyperlink{error_state_kalman_8m_a39b5299925221272d7463a9c44a23c02}{Qg\-Bias} (3, 3)
\item 
\hyperlink{error_state_kalman_8m_a2d0be11e8b84898e72a8832c7bc0863d}{if} (\hyperlink{error_state_kalman_8m_a39b5299925221272d7463a9c44a23c02}{Qg\-Bias}(1, 1)$<$ 1/32768) \hyperlink{error_state_kalman_8m_a39b5299925221272d7463a9c44a23c02}{Qg\-Bias}(1 = 1/32768
\item 
\hyperlink{error_state_kalman_8m_a4b9c96e717de283a1769723c064b3ee7}{Qg\-Scale} (1, 1)
\item 
\hyperlink{error_state_kalman_8m_ae6349c2047507a765eb21ef6b6a39b3b}{Qg\-Scale} (2, 2)
\item 
\hyperlink{error_state_kalman_8m_a2336c76175aa09baa1b87bcd9f86fb6d}{Qg\-Scale} (3, 3)
\item 
\hyperlink{error_state_kalman_8m_ad005c5070c954f594bea7e974342c019}{G} (2)
\item 
\hyperlink{error_state_kalman_8m_a8b3e2536de3b319235d91da4abe2ac8e}{G} (3)\mbox{]}$\ast$\hyperlink{ahrs_8m_a4ff248a90c101bf3e3713c17cd3ffab0}{dt}
\item 
\hyperlink{error_state_kalman_8m_a24f0512dd7bb7dba2d43c1a914a36b58}{eye} (3)
\item 
Hard limit the amount of \\*
rotation \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} acceleration \hyperlink{error_state_kalman_8m_a658d658559dd331229f51b8bba139778}{if} (\hyperlink{error_state_kalman_8m_abf169b45b8bb9a89b379b49828828973}{gy\-Mag} $>$ 1) \hyperlink{error_state_kalman_8m_abf169b45b8bb9a89b379b49828828973}{gy\-Mag}
\item 
\hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_a54d5ae7d5831a7d3a204d0a0060dce28}{if} (b\-Accel $>$ 1) b\-Accel
\item 
b\-Accel/1 \hyperlink{error_state_kalman_8m_ae52152646cd1253bb5c435fea475bdfa}{R} ()
\item 
\hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_a293da3a642d5af83135ac8c56449d72b}{if} (\hyperlink{error_state_kalman_8m_abf169b45b8bb9a89b379b49828828973}{gy\-Mag} $>$.\-17)\%10 degress/\hyperlink{error_state_kalman_8m_a3cbf8063018be67a2f9313a4b99270d8}{sec} \hyperlink{error_state_kalman_8m_ae52152646cd1253bb5c435fea475bdfa}{R}(3
\item 
\hyperlink{error_state_kalman_8m_a802439f8d79db007a9bef99f24868083}{T1} (1, 1)
\item 
\hyperlink{error_state_kalman_8m_ac1e3dca9a095644f4f75823bd976e377}{T1} (2, 2)
\item 
\hyperlink{error_state_kalman_8m_a950ba783dbcfe752ceab5e05ff6c9ebd}{T1} (3, 3)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{error_state_kalman_8m_a599c198560ced1642eab8702305e270f}{function} \mbox{[}\hyperlink{error_state_kalman_8m_ac8927abd96967c52efda717c672f4f8a}{d\-A\-Error}, \hyperlink{error_state_kalman_8m_a8459ea67c34367494089f4a6cac911f1}{d\-G\-Bias}, \hyperlink{error_state_kalman_8m_a413d6fe48b0e04f1b6fa01cfa5924b42}{d\-G\-Scale}\mbox{]}
\item 
\hyperlink{utl__clocks_8h_a4fcd6b27605b68d39da73efe9e419533}{if} \hyperlink{error_state_kalman_8m_a8962acf4367dd234de1125306e9bd51c}{b\-\_\-init\-Flag}
\item 
gyro random noise \hyperlink{mag_plot_8m_a25ed1bcb423b0b7200f485fc5ff71c8e}{z} axis in rad \hyperlink{error_state_kalman_8m_a3cbf8063018be67a2f9313a4b99270d8}{sec}
\item 
\hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} axis \hyperlink{error_state_kalman_8m_a2af4beda54af250a79cafa27ede75b67}{accelerometer}
\item 
\hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} axis \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} \hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} axis magnetometer \\*
referenced in the navigation \\*
frame The values could be \\*
determined dynamically by \\*
measuring the variance \hyperlink{mag_plot_8m_a58ab1fd68e97078232808206b850161b}{on} each \\*
one of these \hyperlink{error_state_kalman_8m_a6f49ba65e7284089292d629f9f8763e0}{parameters}
\item 
\hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} axis \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} \hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} axis magnetometer \\*
referenced in the navigation \\*
frame The values could be \\*
determined dynamically by \\*
measuring the variance \hyperlink{mag_plot_8m_a58ab1fd68e97078232808206b850161b}{on} each \\*
one of these however they were \\*
\hyperlink{mag_plot_8m_ad2662db5453e8a5f0599a49c28da1c65}{set} \hyperlink{error_state_kalman_8m_a51892d19e34a60ed037a355cba8bf6f4}{experimentally}
\item 
Magnetometer \hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} axis \hyperlink{dcm_normalize_8m_a5ee817c076587e88884910406497df94}{error} else \\*
Begin propagation \hyperlink{error_state_kalman_8m_a54df32814dd0fb5603d83390a79c9822}{phase}
\item 
Magnetometer \hyperlink{mag_plot_8m_a2fb1c5cf58867b5bbc9a1b145a86f3a0}{y} axis \hyperlink{dcm_normalize_8m_a5ee817c076587e88884910406497df94}{error} else \\*
Begin propagation \hyperlink{mag_plot_8m_afe627986b4147fc678023fb03e010791}{pitch} \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} \\*
\hyperlink{mag_plot_8m_aaeddb3af347c13f3d0915fb2e613acce}{yaw} process noise whenever \hyperlink{ellipsoid__fit_8m_a44f09445f90540f74824a1839982d0de}{a} \\*
large \hyperlink{dcm_normalize_8m_a5ee817c076587e88884910406497df94}{error} has been \hyperlink{error_state_kalman_8m_af77caa51e970c6d2aa150ee3ed54c209}{detected}
\item 
\hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end}
\item 
\hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_a2af4715890b2203308de1e22aa5ca1f4}{Qg\-Scale} = \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3)
\item 
\hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{end} \hyperlink{error_state_kalman_8m_a20a6a26885fef76595c7dba9d5752fe0}{Q} = \mbox{[}\hyperlink{error_state_kalman_8m_a3e088d997e83bd453fb3f7c3baaba22e}{Qatt}, \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3), \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3)
\item 
\hyperlink{error_state_kalman_8m_a05581e0fc0c73b4773af622195e4b342}{Qg\-Bias}
\item 
\hyperlink{error_state_kalman_8m_a514f1b439f404f86f77090fa9edc96ce}{r}
\item 
\hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} ba removed \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} gyro scale \\*
factor added\mbox{[}2\mbox{]} eq with the \\*
rotation rate removed \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} \\*
attitude propagation term \\*
\hyperlink{error_state_kalman_8m_ada2519cc160a5cdc395c657503f60c3f}{negated}\mbox{[}3\mbox{]} Section with xa \\*
removed \hyperlink{error_state_kalman_8m_a1c89c1f61a58d20f5b337a72833d09ca}{Fg} = 0
\item 
\hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} ba removed \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} gyro scale \\*
factor added\mbox{[}2\mbox{]} eq with the \\*
rotation rate removed \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} \\*
attitude propagation term \\*
negated\mbox{[}3\mbox{]} Section with xa \\*
removed gyro scale rate added \\*
\hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} attitude propagation term \hyperlink{error_state_kalman_8m_ada2519cc160a5cdc395c657503f60c3f}{negated}
\item 
\hyperlink{error_state_kalman_8m_af38c7d58a7d8abaeccfcdd239f342a62}{phi02} = -\/\hyperlink{dcm_normalize_8m_acb1204fdbdc06fd21577791c7d91217d}{D\-C\-M}$\ast$\mbox{[}\hyperlink{error_state_kalman_8m_a8b3e2536de3b319235d91da4abe2ac8e}{G}(1), 0, 0
\item 
\hyperlink{error_state_kalman_8m_aaf40c223796354fb6b79c9ed047c513a}{phi} = \mbox{[}\hyperlink{error_state_kalman_8m_a24f0512dd7bb7dba2d43c1a914a36b58}{eye}(3), phi01, \hyperlink{error_state_kalman_8m_af38c7d58a7d8abaeccfcdd239f342a62}{phi02}
\item 
End propagation \hyperlink{error_state_kalman_8m_a54df32814dd0fb5603d83390a79c9822}{phase} Begin \\*
correction \hyperlink{error_state_kalman_8m_a54df32814dd0fb5603d83390a79c9822}{phase} \hyperlink{error_state_kalman_8m_abf169b45b8bb9a89b379b49828828973}{gy\-Mag} = norm( \hyperlink{error_state_kalman_8m_a8b3e2536de3b319235d91da4abe2ac8e}{G})
\item 
\hyperlink{error_state_kalman_8m_afaafc315b95987fc2b071bcd8f698b81}{H} = \mbox{[}H00, \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3), \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3)\mbox{]}
\item 
they are ignored in order to \\*
avoid \hyperlink{ellipsoid__fit_8m_a44f09445f90540f74824a1839982d0de}{a} matrix \hyperlink{error_state_kalman_8m_a9d2fc51f2b1b87712226d15f305a44e7}{inverse}
\item 
\hyperlink{error_state_kalman_8m_aa7255c4bc0e9fa663f62fbafe1026daa}{T1} = \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3)
\item 
\hyperlink{error_state_kalman_8m_ac8927abd96967c52efda717c672f4f8a}{d\-A\-Error} = x\-Ahrs(1\-:3)
\item 
\hyperlink{error_state_kalman_8m_a8459ea67c34367494089f4a6cac911f1}{d\-G\-Bias} = x\-Ahrs(4\-:6)
\item 
\hyperlink{error_state_kalman_8m_a413d6fe48b0e04f1b6fa01cfa5924b42}{d\-G\-Scale} = x\-Ahrs(7\-:9)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{error_state_kalman_8m_a24f0512dd7bb7dba2d43c1a914a36b58}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!eye@{eye}}
\index{eye@{eye}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{eye}]{\setlength{\rightskip}{0pt plus 5cm}eye (
\begin{DoxyParamCaption}
\item[{3}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a24f0512dd7bb7dba2d43c1a914a36b58}
\hypertarget{error_state_kalman_8m_ad005c5070c954f594bea7e974342c019}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!G@{G}}
\index{G@{G}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{G}]{\setlength{\rightskip}{0pt plus 5cm}G (
\begin{DoxyParamCaption}
\item[{2}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_ad005c5070c954f594bea7e974342c019}
\hypertarget{error_state_kalman_8m_a8b3e2536de3b319235d91da4abe2ac8e}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!G@{G}}
\index{G@{G}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{G}]{\setlength{\rightskip}{0pt plus 5cm}G (
\begin{DoxyParamCaption}
\item[{3}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a8b3e2536de3b319235d91da4abe2ac8e}
\hypertarget{error_state_kalman_8m_abc48706ebe7c3762ebebc1b79cf569dc}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!if@{if}}
\index{if@{if}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{if}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} if (
\begin{DoxyParamCaption}
\item[{{\bf res}(2)}]{, }
\item[{5 $\ast$}]{r\-Var2}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_abc48706ebe7c3762ebebc1b79cf569dc}
\hypertarget{error_state_kalman_8m_a01152faaa45b1077daa95054b190368a}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!if@{if}}
\index{if@{if}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{if}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} if (
\begin{DoxyParamCaption}
\item[{{\bf res}(3)}]{, }
\item[{{\bf r\-Var}(3)}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a01152faaa45b1077daa95054b190368a}
\hypertarget{error_state_kalman_8m_a2d0be11e8b84898e72a8832c7bc0863d}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!if@{if}}
\index{if@{if}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{if}]{\setlength{\rightskip}{0pt plus 5cm}if (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) = 1/32768}}\label{error_state_kalman_8m_a2d0be11e8b84898e72a8832c7bc0863d}
\hypertarget{error_state_kalman_8m_a658d658559dd331229f51b8bba139778}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!if@{if}}
\index{if@{if}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{if}]{\setlength{\rightskip}{0pt plus 5cm}Hard limit the amount of rotation {\bf and} acceleration if (
\begin{DoxyParamCaption}
\item[{{\bf gy\-Mag}}]{, }
\item[{1}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a658d658559dd331229f51b8bba139778}
\hypertarget{error_state_kalman_8m_a54d5ae7d5831a7d3a204d0a0060dce28}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!if@{if}}
\index{if@{if}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{if}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} if (
\begin{DoxyParamCaption}
\item[{b\-Accel}]{, }
\item[{1}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a54d5ae7d5831a7d3a204d0a0060dce28}
\hypertarget{error_state_kalman_8m_a293da3a642d5af83135ac8c56449d72b}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!if@{if}}
\index{if@{if}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{if}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} if (
\begin{DoxyParamCaption}
\item[{{\bf gy\-Mag}}]{, }
\item[{.}]{17}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a293da3a642d5af83135ac8c56449d72b}
\hypertarget{error_state_kalman_8m_a69139acee4d44a784a98346d44cb78c6}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qatt@{Qatt}}
\index{Qatt@{Qatt}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qatt}]{\setlength{\rightskip}{0pt plus 5cm}else Qatt (
\begin{DoxyParamCaption}
\item[{1}]{, }
\item[{1}]{}
\end{DoxyParamCaption}
) = (.\-38$\ast${\bf pi}/180)$\ast${\bf dt}}}\label{error_state_kalman_8m_a69139acee4d44a784a98346d44cb78c6}
\hypertarget{error_state_kalman_8m_a77865d2a79630f6bb4acfbe319d430f0}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qatt@{Qatt}}
\index{Qatt@{Qatt}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qatt}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} else Qatt (
\begin{DoxyParamCaption}
\item[{2}]{, }
\item[{2}]{}
\end{DoxyParamCaption}
) = (.\-38$\ast${\bf pi}/180)$\ast${\bf dt}}}\label{error_state_kalman_8m_a77865d2a79630f6bb4acfbe319d430f0}
\hypertarget{error_state_kalman_8m_a3e088d997e83bd453fb3f7c3baaba22e}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qatt@{Qatt}}
\index{Qatt@{Qatt}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qatt}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} else Qatt (
\begin{DoxyParamCaption}
\item[{3}]{, }
\item[{3}]{}
\end{DoxyParamCaption}
) = (.\-38$\ast${\bf pi}/180)$\ast${\bf dt}}}\label{error_state_kalman_8m_a3e088d997e83bd453fb3f7c3baaba22e}
\hypertarget{error_state_kalman_8m_a1765b8411a385cb7cbfc189a91e6ec36}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qg\-Bias@{Qg\-Bias}}
\index{Qg\-Bias@{Qg\-Bias}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qg\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}Qg\-Bias (
\begin{DoxyParamCaption}
\item[{1}]{, }
\item[{1}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a1765b8411a385cb7cbfc189a91e6ec36}
\hypertarget{error_state_kalman_8m_a4e5570b54d956ce11e4df196479225c2}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qg\-Bias@{Qg\-Bias}}
\index{Qg\-Bias@{Qg\-Bias}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qg\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}Qg\-Bias (
\begin{DoxyParamCaption}
\item[{2}]{, }
\item[{2}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a4e5570b54d956ce11e4df196479225c2}
\hypertarget{error_state_kalman_8m_a39b5299925221272d7463a9c44a23c02}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qg\-Bias@{Qg\-Bias}}
\index{Qg\-Bias@{Qg\-Bias}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qg\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}Qg\-Bias (
\begin{DoxyParamCaption}
\item[{3}]{, }
\item[{3}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a39b5299925221272d7463a9c44a23c02}
\hypertarget{error_state_kalman_8m_a4b9c96e717de283a1769723c064b3ee7}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qg\-Scale@{Qg\-Scale}}
\index{Qg\-Scale@{Qg\-Scale}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qg\-Scale}]{\setlength{\rightskip}{0pt plus 5cm}Qg\-Scale (
\begin{DoxyParamCaption}
\item[{1}]{, }
\item[{1}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a4b9c96e717de283a1769723c064b3ee7}
\hypertarget{error_state_kalman_8m_ae6349c2047507a765eb21ef6b6a39b3b}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qg\-Scale@{Qg\-Scale}}
\index{Qg\-Scale@{Qg\-Scale}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qg\-Scale}]{\setlength{\rightskip}{0pt plus 5cm}Qg\-Scale (
\begin{DoxyParamCaption}
\item[{2}]{, }
\item[{2}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_ae6349c2047507a765eb21ef6b6a39b3b}
\hypertarget{error_state_kalman_8m_a2336c76175aa09baa1b87bcd9f86fb6d}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qg\-Scale@{Qg\-Scale}}
\index{Qg\-Scale@{Qg\-Scale}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qg\-Scale}]{\setlength{\rightskip}{0pt plus 5cm}Qg\-Scale (
\begin{DoxyParamCaption}
\item[{3}]{, }
\item[{3}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a2336c76175aa09baa1b87bcd9f86fb6d}
\hypertarget{error_state_kalman_8m_a9e043f1de5477b7deb4976cd2bd554e2}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!R@{R}}
\index{R@{R}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{R}]{\setlength{\rightskip}{0pt plus 5cm}R (
\begin{DoxyParamCaption}
\item[{1}]{, }
\item[{1}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a9e043f1de5477b7deb4976cd2bd554e2}
\hypertarget{error_state_kalman_8m_aea61c32f128d177a875fe8d6cd1f99e4}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!R@{R}}
\index{R@{R}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{R}]{\setlength{\rightskip}{0pt plus 5cm}Accelerometer {\bf x} {\bf error} R (
\begin{DoxyParamCaption}
\item[{2}]{, }
\item[{2}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_aea61c32f128d177a875fe8d6cd1f99e4}
\hypertarget{error_state_kalman_8m_a7972c14f231c13f8633c0a12e59e317c}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!R@{R}}
\index{R@{R}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{R}]{\setlength{\rightskip}{0pt plus 5cm}Accelerometer {\bf y} {\bf error} R (
\begin{DoxyParamCaption}
\item[{3}]{, }
\item[{3}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a7972c14f231c13f8633c0a12e59e317c}
\hypertarget{error_state_kalman_8m_ae52152646cd1253bb5c435fea475bdfa}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!R@{R}}
\index{R@{R}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{R}]{\setlength{\rightskip}{0pt plus 5cm}b\-Accel/1 R (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{error_state_kalman_8m_ae52152646cd1253bb5c435fea475bdfa}
\hypertarget{error_state_kalman_8m_a802439f8d79db007a9bef99f24868083}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!T1@{T1}}
\index{T1@{T1}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{T1}]{\setlength{\rightskip}{0pt plus 5cm}T1 (
\begin{DoxyParamCaption}
\item[{1}]{, }
\item[{1}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a802439f8d79db007a9bef99f24868083}
\hypertarget{error_state_kalman_8m_ac1e3dca9a095644f4f75823bd976e377}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!T1@{T1}}
\index{T1@{T1}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{T1}]{\setlength{\rightskip}{0pt plus 5cm}T1 (
\begin{DoxyParamCaption}
\item[{2}]{, }
\item[{2}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_ac1e3dca9a095644f4f75823bd976e377}
\hypertarget{error_state_kalman_8m_a950ba783dbcfe752ceab5e05ff6c9ebd}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!T1@{T1}}
\index{T1@{T1}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{T1}]{\setlength{\rightskip}{0pt plus 5cm}T1 (
\begin{DoxyParamCaption}
\item[{3}]{, }
\item[{3}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_a950ba783dbcfe752ceab5e05ff6c9ebd}
\hypertarget{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!zeros@{zeros}}
\index{zeros@{zeros}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{zeros}]{\setlength{\rightskip}{0pt plus 5cm}zeros (
\begin{DoxyParamCaption}
\item[{3}]{}
\end{DoxyParamCaption}
)}}\label{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}


\subsection{Variable Documentation}
\hypertarget{error_state_kalman_8m_a2af4beda54af250a79cafa27ede75b67}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!accelerometer@{accelerometer}}
\index{accelerometer@{accelerometer}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{accelerometer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf y} axis accelerometer}}\label{error_state_kalman_8m_a2af4beda54af250a79cafa27ede75b67}
\hypertarget{error_state_kalman_8m_a8962acf4367dd234de1125306e9bd51c}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!b\-\_\-init\-Flag@{b\-\_\-init\-Flag}}
\index{b\-\_\-init\-Flag@{b\-\_\-init\-Flag}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{b\-\_\-init\-Flag}]{\setlength{\rightskip}{0pt plus 5cm}{\bf if} b\-\_\-init\-Flag}}\label{error_state_kalman_8m_a8962acf4367dd234de1125306e9bd51c}
{\bfseries Initial value\-:}
\begin{DoxyCode}
==================================================================
        % Initalize the attitude \hyperlink{dcm_normalize_8m_a5ee817c076587e88884910406497df94}{error} portion of the system noise (process 
        % noise) matrix. The value .38 was pulled from the ITG-3200 
        % datasheet
        % [1] eq 12.67
        %==================================================================         
        \hyperlink{error_state_kalman_8m_a69139acee4d44a784a98346d44cb78c6}{Qatt} = \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3)
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_ac8927abd96967c52efda717c672f4f8a}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!d\-A\-Error@{d\-A\-Error}}
\index{d\-A\-Error@{d\-A\-Error}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{d\-A\-Error}]{\setlength{\rightskip}{0pt plus 5cm}d\-A\-Error = x\-Ahrs(1\-:3)}}\label{error_state_kalman_8m_ac8927abd96967c52efda717c672f4f8a}
\hypertarget{error_state_kalman_8m_af77caa51e970c6d2aa150ee3ed54c209}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!detected@{detected}}
\index{detected@{detected}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{detected}]{\setlength{\rightskip}{0pt plus 5cm}Magnetometer {\bf y} axis {\bf error} else Begin propagation {\bf pitch} {\bf and} {\bf yaw} process noise whenever {\bf a} large {\bf error} has been detected}}\label{error_state_kalman_8m_af77caa51e970c6d2aa150ee3ed54c209}
{\bfseries Initial value\-:}
\begin{DoxyCode}
==================================================================
        \textcolor{keywordflow}{if}( \hyperlink{ahrs_8m_abcb9e071857020e3d766bca269d2c94f}{res}(1) > 5*\hyperlink{ahrs_8m_ae8b4ff61c39c5c2ea8ece84aed662c7f}{rVar}(1))
           \hyperlink{error_state_kalman_8m_a69139acee4d44a784a98346d44cb78c6}{Qatt}(1,1) = .2
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_a8459ea67c34367494089f4a6cac911f1}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!d\-G\-Bias@{d\-G\-Bias}}
\index{d\-G\-Bias@{d\-G\-Bias}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{d\-G\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}d\-G\-Bias = x\-Ahrs(4\-:6)}}\label{error_state_kalman_8m_a8459ea67c34367494089f4a6cac911f1}
\hypertarget{error_state_kalman_8m_a413d6fe48b0e04f1b6fa01cfa5924b42}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!d\-G\-Scale@{d\-G\-Scale}}
\index{d\-G\-Scale@{d\-G\-Scale}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{d\-G\-Scale}]{\setlength{\rightskip}{0pt plus 5cm}d\-G\-Scale = x\-Ahrs(7\-:9)}}\label{error_state_kalman_8m_a413d6fe48b0e04f1b6fa01cfa5924b42}
\hypertarget{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!end@{end}}
\index{end@{end}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{end}]{\setlength{\rightskip}{0pt plus 5cm}end}}\label{error_state_kalman_8m_afb358f48b1646c750fb9da6c6585be2b}
{\bfseries Initial value\-:}
\begin{DoxyCode}
==================================================================
        % Update gyro \hyperlink{ahrs_8m_aebc7d7462b5d60cbdfd443bacf4d3132}{bias} \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} gyro scale factor system (process) noise. 
        % The value is \hyperlink{mag_plot_8m_ad2662db5453e8a5f0599a49c28da1c65}{set} to 10% of the current \hyperlink{ahrs_8m_aebc7d7462b5d60cbdfd443bacf4d3132}{bias} \hyperlink{ahrs_8m_afa199521a240e64469e26df8973798f0}{and} scale factor
        % estimate.
        % [1] section 4.4.1
        %==================================================================
        \hyperlink{error_state_kalman_8m_a05581e0fc0c73b4773af622195e4b342}{QgBias} = \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3)
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_a51892d19e34a60ed037a355cba8bf6f4}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!experimentally@{experimentally}}
\index{experimentally@{experimentally}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{experimentally}]{\setlength{\rightskip}{0pt plus 5cm}{\bf y} axis {\bf and} {\bf y} axis magnetometer referenced in the navigation frame The values could be determined dynamically by measuring the variance {\bf on} each one of these however they were {\bf set} experimentally}}\label{error_state_kalman_8m_a51892d19e34a60ed037a355cba8bf6f4}
{\bfseries Initial value\-:}
\begin{DoxyCode}
==================================================================         
        \hyperlink{ellipsoid__fit_8m_a0068887ae91b4d52177f72ed707e6981}{R} = \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3)
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_a1c89c1f61a58d20f5b337a72833d09ca}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Fg@{Fg}}
\index{Fg@{Fg}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Fg}]{\setlength{\rightskip}{0pt plus 5cm}{\bf and} ba removed {\bf and} gyro scale factor added \mbox{[}2\mbox{]} eq with the rotation rate removed {\bf and} attitude propagation term {\bf negated} \mbox{[}3\mbox{]} Section with xa removed Fg = 0}}\label{error_state_kalman_8m_a1c89c1f61a58d20f5b337a72833d09ca}
\hypertarget{error_state_kalman_8m_a599c198560ced1642eab8702305e270f}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!function@{function}}
\index{function@{function}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{function}]{\setlength{\rightskip}{0pt plus 5cm}function\mbox{[}{\bf d\-A\-Error}, {\bf d\-G\-Bias}, {\bf d\-G\-Scale}\mbox{]}}}\label{error_state_kalman_8m_a599c198560ced1642eab8702305e270f}
{\bfseries Initial value\-:}
\begin{DoxyCode}
= errorStateKalman( \hyperlink{error_state_kalman_8m_a8962acf4367dd234de1125306e9bd51c}{b\_initFlag}, \hyperlink{ahrs_8m_a6c09ea21d23865d2f25f4a050d6c0c3b}{deltaZ}, gBias, \hyperlink{ahrs_8m_a41ff8572fa45a49861e7dbd98b46143f}{gScale}, \hyperlink{dcm_update_8m_acdb352fc59a62626a408e91be74f7414}{DCM}, 
      \hyperlink{ahrs_8m_a4ff248a90c101bf3e3713c17cd3ffab0}{dt}, \hyperlink{error_state_kalman_8m_ad005c5070c954f594bea7e974342c019}{G}, bAccel, \hyperlink{ahrs_8m_abcb9e071857020e3d766bca269d2c94f}{res}, \hyperlink{ahrs_8m_ae8b4ff61c39c5c2ea8ece84aed662c7f}{rVar})
    persistent H00 \hyperlink{error_state_kalman_8m_afaafc315b95987fc2b071bcd8f698b81}{H} \hyperlink{error_state_kalman_8m_a20a6a26885fef76595c7dba9d5752fe0}{Q} \hyperlink{error_state_kalman_8m_a69139acee4d44a784a98346d44cb78c6}{Qatt} \hyperlink{error_state_kalman_8m_aaf40c223796354fb6b79c9ed047c513a}{phi} phi01 \hyperlink{ellipsoid__fit_8m_a0068887ae91b4d52177f72ed707e6981}{R} P
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_abf169b45b8bb9a89b379b49828828973}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!gy\-Mag@{gy\-Mag}}
\index{gy\-Mag@{gy\-Mag}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{gy\-Mag}]{\setlength{\rightskip}{0pt plus 5cm}End propagation {\bf phase} Begin correction {\bf phase} gy\-Mag = norm( {\bf G})}}\label{error_state_kalman_8m_abf169b45b8bb9a89b379b49828828973}
\hypertarget{error_state_kalman_8m_afaafc315b95987fc2b071bcd8f698b81}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!H@{H}}
\index{H@{H}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{H}]{\setlength{\rightskip}{0pt plus 5cm}H = \mbox{[}H00, {\bf zeros}(3), {\bf zeros}(3)\mbox{]}}}\label{error_state_kalman_8m_afaafc315b95987fc2b071bcd8f698b81}
\hypertarget{error_state_kalman_8m_a9d2fc51f2b1b87712226d15f305a44e7}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!inverse@{inverse}}
\index{inverse@{inverse}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{inverse}]{\setlength{\rightskip}{0pt plus 5cm}they are ignored in order to avoid {\bf a} matrix inverse}}\label{error_state_kalman_8m_a9d2fc51f2b1b87712226d15f305a44e7}
{\bfseries Initial value\-:}
\begin{DoxyCode}
==================================================================         
        \hyperlink{ahrs_8m_ae49740b4cb1b92c947eb5c14ac953acf}{T} = \hyperlink{error_state_kalman_8m_afaafc315b95987fc2b071bcd8f698b81}{H}*P*\hyperlink{error_state_kalman_8m_afaafc315b95987fc2b071bcd8f698b81}{H}\textcolor{stringliteral}{'+ R}
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_ada2519cc160a5cdc395c657503f60c3f}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!negated@{negated}}
\index{negated@{negated}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{negated}]{\setlength{\rightskip}{0pt plus 5cm}{\bf and} ba removed {\bf and} gyro scale factor added \mbox{[}2\mbox{]} eq with the rotation rate removed {\bf and} attitude propagation term negated \mbox{[}3\mbox{]} Section with xa removed gyro scale rate added {\bf and} attitude propagation term negated}}\label{error_state_kalman_8m_ada2519cc160a5cdc395c657503f60c3f}
{\bfseries Initial value\-:}
\begin{DoxyCode}
==================================================================        
        phi01 = \hyperlink{dcm_update_8m_acdb352fc59a62626a408e91be74f7414}{DCM}*\hyperlink{ahrs_8m_a4ff248a90c101bf3e3713c17cd3ffab0}{dt}
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_a6f49ba65e7284089292d629f9f8763e0}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!parameters@{parameters}}
\index{parameters@{parameters}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{parameters}]{\setlength{\rightskip}{0pt plus 5cm}{\bf y} axis {\bf and} {\bf y} axis magnetometer referenced in the navigation frame The values could be determined dynamically by measuring the variance {\bf on} each one of these parameters}}\label{error_state_kalman_8m_a6f49ba65e7284089292d629f9f8763e0}
\hypertarget{error_state_kalman_8m_a54df32814dd0fb5603d83390a79c9822}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!phase@{phase}}
\index{phase@{phase}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{phase}]{\setlength{\rightskip}{0pt plus 5cm}Magnetometer {\bf y} axis {\bf error} else Begin propagation phase}}\label{error_state_kalman_8m_a54df32814dd0fb5603d83390a79c9822}
{\bfseries Initial value\-:}
\begin{DoxyCode}
==================================================================
        % Update attitude system (process) noise. This \hyperlink{mag_plot_8m_ae5f3bfeb7e3cb5c8bc769d5504ebeeae}{step} corrects for
        % Kalman tracking errors by increasing the \hyperlink{acc_roll_pitch_8m_a7993a910e3864ada05ae35fe7205d276}{roll}
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_aaf40c223796354fb6b79c9ed047c513a}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!phi@{phi}}
\index{phi@{phi}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{phi}]{\setlength{\rightskip}{0pt plus 5cm}phi = \mbox{[}{\bf eye}(3), phi01, {\bf phi02}}}\label{error_state_kalman_8m_aaf40c223796354fb6b79c9ed047c513a}
\hypertarget{error_state_kalman_8m_af38c7d58a7d8abaeccfcdd239f342a62}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!phi02@{phi02}}
\index{phi02@{phi02}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{phi02}]{\setlength{\rightskip}{0pt plus 5cm}phi02 = -\/{\bf D\-C\-M}$\ast$\mbox{[}{\bf G}(1), 0, 0}}\label{error_state_kalman_8m_af38c7d58a7d8abaeccfcdd239f342a62}
\hypertarget{error_state_kalman_8m_a20a6a26885fef76595c7dba9d5752fe0}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Q@{Q}}
\index{Q@{Q}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Q}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} {\bf end} {\bf end} Q = \mbox{[}{\bf Qatt}, {\bf zeros}(3), {\bf zeros}(3)}}\label{error_state_kalman_8m_a20a6a26885fef76595c7dba9d5752fe0}
\hypertarget{error_state_kalman_8m_a05581e0fc0c73b4773af622195e4b342}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qg\-Bias@{Qg\-Bias}}
\index{Qg\-Bias@{Qg\-Bias}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qg\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}Qg\-Bias}}\label{error_state_kalman_8m_a05581e0fc0c73b4773af622195e4b342}
\hypertarget{error_state_kalman_8m_a2af4715890b2203308de1e22aa5ca1f4}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!Qg\-Scale@{Qg\-Scale}}
\index{Qg\-Scale@{Qg\-Scale}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{Qg\-Scale}]{\setlength{\rightskip}{0pt plus 5cm}Qg\-Scale = {\bf zeros}(3)}}\label{error_state_kalman_8m_a2af4715890b2203308de1e22aa5ca1f4}
\hypertarget{error_state_kalman_8m_a514f1b439f404f86f77090fa9edc96ce}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!r@{r}}
\index{r@{r}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{r}]{\setlength{\rightskip}{0pt plus 5cm}r}}\label{error_state_kalman_8m_a514f1b439f404f86f77090fa9edc96ce}
\hypertarget{error_state_kalman_8m_a3cbf8063018be67a2f9313a4b99270d8}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!sec@{sec}}
\index{sec@{sec}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{sec}]{\setlength{\rightskip}{0pt plus 5cm}gyro random noise {\bf z} axis in rad sec}}\label{error_state_kalman_8m_a3cbf8063018be67a2f9313a4b99270d8}
{\bfseries Initial value\-:}
\begin{DoxyCode}
==================================================================
        % Initialize the \hyperlink{dcm_normalize_8m_a5ee817c076587e88884910406497df94}{error} covariance 9x9 matrix to \hyperlink{ahrs_8m_af470882f7e2022851bcd30badb9762f1}{all} \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros} since
        % \textcolor{keyword}{this} is an \hyperlink{dcm_normalize_8m_a5ee817c076587e88884910406497df94}{error}-state not total-state Kalman filter.
        % [1] section 3.2.1 eq 3.5
        %==================================================================     
        P = [ \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3), \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3), \hyperlink{error_state_kalman_8m_aa4a09e5b046bcf56ad20ff9257147ecf}{zeros}(3)
\end{DoxyCode}
\hypertarget{error_state_kalman_8m_aa7255c4bc0e9fa663f62fbafe1026daa}{\index{error\-State\-Kalman.\-m@{error\-State\-Kalman.\-m}!T1@{T1}}
\index{T1@{T1}!errorStateKalman.m@{error\-State\-Kalman.\-m}}
\subsubsection[{T1}]{\setlength{\rightskip}{0pt plus 5cm}T1 = {\bf zeros}(3)}}\label{error_state_kalman_8m_aa7255c4bc0e9fa663f62fbafe1026daa}
